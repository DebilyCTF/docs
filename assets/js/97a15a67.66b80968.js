"use strict";(self.webpackChunkweb_ctf=self.webpackChunkweb_ctf||[]).push([[572],{4973:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>o,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>p,toc:()=>c});var n=s(5893),r=s(1151);const a={},i="PHP Master (50 points)",p={id:"writeups/X-MAS/2020/php_master",title:"PHP Master (50 points)",description:"Description",source:"@site/docs/writeups/X-MAS/2020/php_master.md",sourceDirName:"writeups/X-MAS/2020",slug:"/writeups/X-MAS/2020/php_master",permalink:"/ctf-docs/docs/writeups/X-MAS/2020/php_master",draft:!1,unlisted:!1,editUrl:"https://github.com/boyney123/eventcatalog/edit/master/website/docs/writeups/X-MAS/2020/php_master.md",tags:[],version:"current",lastUpdatedBy:"kostezy",frontMatter:{},sidebar:"writeups",previous:{title:"Many Paths (500 points)",permalink:"/ctf-docs/docs/writeups/X-MAS/2020/many_paths"},next:{title:"Santa's consolation (500 points)",permalink:"/ctf-docs/docs/writeups/X-MAS/2020/santas_consolation"}},o={},c=[{value:"Description",id:"description",level:2},{value:"Solution",id:"solution",level:2}];function l(e){const t=Object.assign({h1:"h1",h2:"h2",p:"p",em:"em",a:"a",pre:"pre",code:"code"},(0,r.ah)(),e.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{id:"php-master-50-points",children:"PHP Master (50 points)"}),"\n",(0,n.jsx)(t.h2,{id:"description",children:"Description"}),"\n",(0,n.jsxs)(t.p,{children:["Another one of ",(0,n.jsx)(t.em,{children:"those"})," challenges."]}),"\n",(0,n.jsxs)(t.p,{children:["Target: ",(0,n.jsx)(t.a,{href:"http://challs.xmas.htsp.ro:3000/",children:"http://challs.xmas.htsp.ro:3000/"})]}),"\n",(0,n.jsx)(t.p,{children:"Author: yakuhito"}),"\n",(0,n.jsx)(t.h2,{id:"solution",children:"Solution"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-php",children:"<?php\n\ninclude('flag.php');\n\n$p1 = $_GET['param1'];\n$p2 = $_GET['param2'];\n\nif(!isset($p1) || !isset($p2)) {\n    highlight_file(__FILE__);\n    die();\n}\n\nif(strpos($p1, 'e') === false && strpos($p2, 'e') === false  && strlen($p1) === strlen($p2) && $p1 !== $p2 && $p1[0] != '0' && $p1 == $p2) {\n    die($flag);\n}\n\n?>\n"})}),"\n",(0,n.jsxs)(t.p,{children:["You just need to bypass the filters here. You can see that there are two comparison operators, one just checks the similarity (==), and the other checks the similarity of types (===). I opened the ",(0,n.jsx)(t.a,{href:"https://www.php.net/manual/en/language.operators.comparison.php",children:"documentation"})," and immediately found the answer."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-php",children:'var_dump(100 == "1e2"); // 100 == 100 -> true\n'})}),"\n",(0,n.jsx)(t.p,{children:'But we need to bypass one more filter: the presence of the letter "e" in the string. Simple as it is, just make it uppercase. As a result, we got such a request:'}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-url",children:"http://challs.xmas.htsp.ro:3000/?param1=1E2&param2=100\n"})}),"\n",(0,n.jsx)(t.p,{children:"Flag: X-MAS{s0_php_m4ny_skillz-69acb43810ed4c42}"})]})}const h=function(e={}){const{wrapper:t}=Object.assign({},(0,r.ah)(),e.components);return t?(0,n.jsx)(t,Object.assign({},e,{children:(0,n.jsx)(l,e)})):l(e)}},1151:(e,t,s)=>{s.d(t,{Zo:()=>p,ah:()=>a});var n=s(7294);const r=n.createContext({});function a(e){const t=n.useContext(r);return n.useMemo((()=>"function"==typeof e?e(t):{...t,...e}),[t,e])}const i={};function p({components:e,children:t,disableParentContext:s}){let p;return p=s?"function"==typeof e?e({}):e||i:a(e),n.createElement(r.Provider,{value:p},t)}}}]);