"use strict";(self.webpackChunkweb_ctf=self.webpackChunkweb_ctf||[]).push([[506],{340:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>c,toc:()=>r});var s=t(5893),o=t(1151);const i={},a="Santa's consolation (500 points)",c={id:"writeups/X-MAS/2020/santas_consolation",title:"Santa's consolation (500 points)",description:"Description",source:"@site/docs/writeups/X-MAS/2020/santas_consolation.md",sourceDirName:"writeups/X-MAS/2020",slug:"/writeups/X-MAS/2020/santas_consolation",permalink:"/docs/writeups/X-MAS/2020/santas_consolation",draft:!1,unlisted:!1,editUrl:"https://github.com/boyney123/eventcatalog/edit/master/website/docs/writeups/X-MAS/2020/santas_consolation.md",tags:[],version:"current",lastUpdatedBy:"kostezy",frontMatter:{},sidebar:"writeups",previous:{title:"PHP Master (50 points)",permalink:"/docs/writeups/X-MAS/2020/php_master"},next:{title:"Slowest Fastest (500 points)",permalink:"/docs/writeups/X-MAS/2020/slowest_fastest"}},l={},r=[{value:"Description",id:"description",level:2},{value:"Solution",id:"solution",level:2}];function d(e){const n=Object.assign({h1:"h1",h2:"h2",p:"p",a:"a",pre:"pre",code:"code",strong:"strong"},(0,o.ah)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"santas-consolation-500-points",children:"Santa's consolation (500 points)"}),"\n",(0,s.jsx)(n.h2,{id:"description",children:"Description"}),"\n",(0,s.jsx)(n.p,{children:"Santa's been sending his regards; he would like to know who will still want to hack stuff after his CTF is over."}),"\n",(0,s.jsx)(n.p,{children:"Note: Bluuk is a multilingual bug bounty platform that will launch soon and we've prepared a challenge for you. Subscribe and stay tuned!"}),"\n",(0,s.jsxs)(n.p,{children:["Target: ",(0,s.jsx)(n.a,{href:"https://bluuk.io",children:"https://bluuk.io"})]}),"\n",(0,s.jsx)(n.p,{children:"Author: littlewho"}),"\n",(0,s.jsx)(n.h2,{id:"solution",children:"Solution"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"console.log(\"\ud83d\udc22 Javascript Challenge \ud83d\udc22\");\nconsole.log(\"Call win(<string>) with the correct parameter to get the flag\");\nconsole.log(\"And don't forget to subscribe to our newsletter :D\");\n\nfunction check(s) {\n    const k = \"MkVUTThoak44TlROOGR6TThaak44TlROOGR6TThWRE14d0hPMnczTTF3M056d25OMnczTTF3M056d1hPNXdITzJ3M00xdzNOenduTjJ3M00xdzNOendYTndFRGY0WURmelVEZjNNRGYyWURmelVEZjNNRGYwRVRNOGhqTjhOVE44ZHpNOFpqTjhOVE44ZHpNOEZETXh3SE8ydzNNMXczTnp3bk4ydzNNMXczTnp3bk13RURmNFlEZnpVRGYzTURmMllEZnpVRGYzTURmeUlUTThoak44TlROOGR6TThaak44TlROOGR6TThCVE14d0hPMnczTTF3M056d25OMnczTTF3M056dzNOeEVEZjRZRGZ6VURmM01EZjJZRGZ6VURmM01EZjFBVE04aGpOOE5UTjhkek04WmpOOE5UTjhkek04bFRPOGhqTjhOVE44ZHpNOFpqTjhOVE44ZHpNOGRUTzhoak44TlROOGR6TThaak44TlROOGR6TThSVE14d0hPMnczTTF3M056d25OMnczTTF3M056d1hPNXdITzJ3M00xdzNOenduTjJ3M00xdzNOenduTXlFRGY0WURmelVEZjNNRGYyWURmelVEZjNNRGYzRVRNOGhqTjhOVE44ZHpNOFpqTjhOVE44ZHpNOGhETjhoak44TlROOGR6TThaak44TlROOGR6TThGak14d0hPMnczTTF3M056d25OMnczTTF3M056d25NeUVEZjRZRGZ6VURmM01EZjJZRGZ6VURmM01EZjFFVE04aGpOOE5UTjhkek04WmpOOE5UTjhkek04RkRNeHdITzJ3M00xdzNOenduTjJ3M00xdzNOendITndFRGY0WURmelVEZjNNRGYyWURmelVEZjNNRGYxRVRNOGhqTjhOVE44ZHpNOFpqTjhOVE44ZHpNOFZETXh3SE8ydzNNMXczTnp3bk4ydzNNMXczTnp3WE94RURmNFlEZnpVRGYzTURmMllEZnpVRGYzTURmeUlUTThoak44TlROOGR6TThaak44TlROOGR6TThkVE84aGpOOE5UTjhkek04WmpOOE5UTjhkek04WlRNeHdITzJ3M00xdzNOenduTjJ3M00xdzNOendITXhFRGY0WURmelVEZjNNRGYyWURmelVEZjNNRGYza0RmNFlEZnpVRGYzTURmMllEZnpVRGYzTURmMUVUTTAwMDBERVRDQURFUg==\";\n    const k1 = atob(k).split('').reverse().join('');\n    return bobify(s) === k1;\n}\n\nfunction bobify(s) {\n    if (~s.indexOf('a') || ~s.indexOf('t') || ~s.indexOf('e') || ~s.indexOf('i') || ~s.indexOf('z')) return \"[REDACTED]\";\n    const s1 = s.replace(/4/g, 'a').replace(/3/g, 'e').replace(/1/g, 'i').replace(/7/g, 't').replace(/_/g, 'z').split('').join('[]');\n    const s2 = encodeURI(s1).split('').map(c => c.charCodeAt(0)).join('|');\n    const s3 = btoa(\"D@\\xc0\\t1\\x03\\xd3M4\" + s2);\n    return s3;\n}\n\nfunction win(x) {\n    return check(x) ? \"X-MAS{\" + x + \"}\" : \"[REDACTED]\";\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:'We need to decode "k" from base64 and reverse. Then I decided to decode the resulting string from base64 again:'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"D@\xc0\t1.\xd3M4115|37|53|66|37|53|68|97|37|53|66|37|53|68|110|37|53|66|37|53|68|116|37|53|66|37|53|68|97|37|53|66|37|53|68|122|37|53|66|37|53|68|119|37|53|66|37|53|68|105|37|53|66|37|53|68|115|37|53|66|37|53|68|104|37|53|66|37|53|68|101|37|53|66|37|53|68|115|37|53|66|37|53|68|122|37|53|66|37|53|68|121|37|53|66|37|53|68|48|37|53|66|37|53|68|117|37|53|66|37|53|68|122|37|53|66|37|53|68|99|37|53|66|37|53|68|114|37|53|66|37|53|68|97|37|53|66|37|53|68|99|37|53|66|37|53|68|105|37|53|66|37|53|68|117|37|53|66|37|53|68|110|37|53|66|37|53|68|122|37|53|66|37|53|68|102|37|53|66|37|53|68|101|37|53|66|37|53|68|114|37|53|66|37|53|68|105|37|53|66|37|53|68|99|37|53|66|37|53|68|105|37|53|66|37|53|68|116\n"})}),"\n",(0,s.jsx)(n.p,{children:"Then i decoded it from decimal:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"s%5B%5Da%5B%5Dn%5B%5Dt%5B%5Da%5B%5Dz%5B%5Dw%5B%5Di%5B%5Ds%5B%5Dh%5B%5De%5B%5Ds%5B%5Dz%5B%5Dy%5B%5D0%5B%5Du%5B%5Dz%5B%5Dc%5B%5Dr%5B%5Da%5B%5Dc%5B%5Di%5B%5Du%5B%5Dn%5B%5Dz%5B%5Df%5B%5De%5B%5Dr%5B%5Di%5B%5Dc%5B%5Di%5B%5Dt\n"})}),"\n",(0,s.jsx)(n.p,{children:"And url decode for now:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"s[]a[]n[]t[]a[]z[]w[]i[]s[]h[]e[]s[]z[]y[]0[]u[]z[]c[]r[]a[]c[]i[]u[]n[]z[]f[]e[]r[]i[]c[]i[]t\n"})}),"\n",(0,s.jsxs)(n.p,{children:['So, lets get rid of unnecessary symbols ("[" and "]"), then change some symbols which are specified in the function ',(0,s.jsx)(n.strong,{children:"bobify"})," and provide it to win function to check whether the flag is true:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"s4n74_w1sh3s_y0u_cr4c1un_f3r1c17\n"})}),"\n",(0,s.jsx)(n.p,{children:"Flag: X-MAS{s4n74_w1sh3s_y0u_cr4c1un_f3r1c17}"})]})}const h=function(e={}){const{wrapper:n}=Object.assign({},(0,o.ah)(),e.components);return n?(0,s.jsx)(n,Object.assign({},e,{children:(0,s.jsx)(d,e)})):d(e)}},1151:(e,n,t)=>{t.d(n,{Zo:()=>c,ah:()=>i});var s=t(7294);const o=s.createContext({});function i(e){const n=s.useContext(o);return s.useMemo((()=>"function"==typeof e?e(n):{...n,...e}),[n,e])}const a={};function c({components:e,children:n,disableParentContext:t}){let c;return c=t?"function"==typeof e?e({}):e||a:i(e),s.createElement(o.Provider,{value:c},n)}}}]);